Custom hook for handling authentication